#include "piece.h"


uint8_t PIECES[__PIECE_COUNT][4][PIECE_BLOCKS][PIECE_BLOCKS] = {
    {
        {
            {0, 0, 0, 0},
            {1, 1, 1, 1},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 1, 0},
            {0, 0, 1, 0},
            {0, 0, 1, 0},
            {0, 0, 1, 0}
        },
        {
            {0, 0, 0, 0},
            {0, 0, 0, 0},
            {1, 1, 1, 1},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 1, 0, 0}
        }
    },
    {
        {
            {1, 0, 0, 0},
            {1, 1, 1, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 1, 0},
            {0, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 0, 0},
            {1, 1, 1, 0},
            {0, 0, 1, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {0, 1, 0, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0}
        }
    },
    {
        {
            {0, 0, 1, 0},
            {1, 1, 1, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 1, 1, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 0, 0},
            {1, 1, 1, 0},
            {1, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {1, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        }
    },
    {
        {
            {1, 1, 0, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {1, 1, 0, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {1, 1, 0, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {1, 1, 0, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
    },
    {
        {
            {0, 1, 1, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {0, 1, 1, 0},
            {0, 0, 1, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 0, 0},
            {0, 1, 1, 0},
            {1, 1, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {1, 0, 0, 0},
            {1, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        }
    },
    {
        {
            {0, 1, 0, 0},
            {1, 1, 1, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {0, 1, 1, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 0, 0},
            {1, 1, 1, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {1, 1, 0, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        }
    },
    {
        {
            {1, 1, 0, 0},
            {0, 1, 1, 0},
            {0, 0, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 1, 0},
            {0, 1, 1, 0},
            {0, 1, 0, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 0, 0, 0},
            {1, 1, 0, 0},
            {0, 1, 1, 0},
            {0, 0, 0, 0}
        },
        {
            {0, 1, 0, 0},
            {1, 1, 0, 0},
            {1, 0, 0, 0},
            {0, 0, 0, 0}
        }
    }
};


uint8_t PIECE_SPAWNS[__PIECE_COUNT][2] = {
    {3, 0},
    {3, 0},
    {3, 0},
    {4, 0},
    {3, 0},
    {3, 0},
    {3, 0}
};


int8_t PIECE_I_WALL_KICK_DATA[PIECE_POSSIBLE_ROTATIONS][PIECE_WALL_DATA_TESTS][2] = {
    // Initial -> right rotation 1
    {
        {  0,  0 },   // Test 1 - basic rotation
        { -2,  0 },  // Test 2
        {  1,  0 },   // Test 3
        { -2,  1 },  // Test 4
        {  1, -2 }   // Test 5
    },
    // Right rotation 1 -> initial
    {
        {  0,  0 },
        {  2,  0 },
        { -1,  0 },
        {  2, -1 },
        { -1,  2}
    },
    // Right rotation 1 -> right rotation 2
    {
        {  0,  0 },
        { -1,  0 },
        {  2,  0 },
        { -1, -2 },
        {  2,  1 }
    },
    // Right rotation 2 -> right rotation 1
    {
        {  0,  0 },
        {  1,  0 },
        { -2,  0 },
        {  1,  2 },
        { -2, -1 }
    },
    // Right rotation 2 -> right rotation 3
    {
        {  0,  0 },
        {  2,  0 },
        { -1,  0 },
        {  2, -1 },
        { -1,  2 }
    },
    // Right rotation 3 -> right rotation 2
    {
        {  0,  0 },
        { -2,  0 },
        {  1,  0 },
        { -2,  1 },
        {  1, -2 }
    },
    // Right rotation 3 -> initial
    {
        {  0,  0 },
        {  1,  0 },
        { -2,  0 },
        {  1,  2 },
        { -2, -1 }
    },
    // Initial -> right rotation 3
    {
        {  0,  0 },
        { -1,  0 },
        {  2,  0 },
        { -1, -2},
        {  2,  1 }
    }
};


int8_t PIECE_JLTSZ_WALL_KICK_DATA[PIECE_POSSIBLE_ROTATIONS][PIECE_WALL_DATA_TESTS][2] = {
    // Initial -> right rotation 1
    {
        {  0,  0 },   // Test 1 - basic rotation
        { -1,  0 },  // Test 2
        { -1, -1 },   // Test 3
        {  0,  2 },  // Test 4
        { -1,  2 }   // Test 5
    },
    // Right rotation 1 -> initial
    {
        {  0,  0 },
        {  1,  0 },
        {  1,  1 },
        {  0, -2 },
        {  1, -2 }
    },
    // Right rotation 1 -> right rotation 2
    {
        {  0,  0 },
        {  1,  0 },
        {  1,  1 },
        {  0, -2 },
        {  1, -2 }
    },
    // Right rotation 2 -> right rotation 1
    {
        {  0,  0 },
        { -1,  0 },
        { -1, -1 },
        {  0,  2 },
        { -1,  2 }
    },
    // Right rotation 2 -> right rotation 3
    {
        {  0,  0 },
        {  1,  0 },
        {  1, -1 },
        {  0,  2 },
        {  1,  2 }
    },
    // Right rotation 3 -> right rotation 2
    {
        {  0,  0 },
        { -1,  0 },
        { -1,  1 },
        {  0, -2 },
        { -1, -2 }
    },
    // Right rotation 3 -> initial
    {
        {  0,  0 },
        { -1,  0 },
        { -1,  1 },
        {  0, -2 },
        { -1, -2 }
    },
    // Initial -> right rotation 3
    {
        {  0,  0 },
        {  1,  0 },
        {  1, -1 },
        {  0,  2 },
        {  1,  2 }
    }
};


int8_t get_wall_data_tests_index(uint8_t old_rot, uint8_t new_rot) {
    if (old_rot == 0 && new_rot == 1) return 0;
    else if (old_rot == 1 && new_rot == 0) return 1;
    else if (old_rot == 1 && new_rot == 2) return 2;
    else if (old_rot == 2 && new_rot == 1) return 3;
    else if (old_rot == 2 && new_rot == 3) return 4;
    else if (old_rot == 3 && new_rot == 2) return 5;
    else if (old_rot == 3 && new_rot == 0) return 6;
    else if (old_rot == 0 && new_rot == 3) return 7;
    return -1;  // invalid input
}
